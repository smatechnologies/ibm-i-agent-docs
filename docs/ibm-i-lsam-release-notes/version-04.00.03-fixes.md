---
sidebar_label: 'Version 04.00.03 Fixes'
---

# Version 04.00.03 Fixes

## 2018 December
| Fixes            | Description |
| ---------------- | ----------- |
| Fixed            | (#403320) This is a CRITICAL fix for the IBM i LSAM data Export/Import tools. The LSAM Dynamic Variable Auxiliary file is added to the Export/Import programs. Previously, the new Dynamic Variable “Function Code” features were added to the LSAM, but the Export program was failing to include the Dynamic Variables Auxiliary table (LSAVARF10) in the export data. |
| Fixed            | (#403321) The IBM i LSAM data Export/Import tools were failing to submit an Export or Import process to a batch job. The programs were trying to use the Job Description name for the JOBQ parameter of the SBMJOB command. The work-around has been to run the process from the interactive job. After this patch the option to submit an Export or Import process to a batch job will work. (PTF # 403324 will perform a check and update for any Dynamic Variables that were stored with names using lower-case letters. To properly support case-insensitivity, Dynamic Variables must always be stored with all CAPITAL letters.) |
| Fixed            | (#403322-403323) The IBM i LSAM Dynamic Variable processing gets the following fixes and improvements: |
|                  | - The TO-Format formula was not always preserved for variables using the *DATE Function Code when using Change or Copy maintenance. |
|                  | - The Character Trim feature (Start/Length) is made more flexible and predictable. New edits in the Dynamic Variable maintenance program help prevent errors and explain how the definition fields work.  |
| Fixed            | (#403333) The IBM i LSAM SCANSPLF (Scan Spool File) utility was failing to preserve leading spaces in some comparison values and value search label fields. Only trailing spaces are typically trimmed from a character string, and trailing spaces are only preserved if a value length is specified in a Scan Rule (or an associated Response Rule). In contrast, leading spaces are supposed to be preserved and not trimmed. The incorrect trimming of leading spaces was causing some character string comparisons to fail when they should have passed. |
| Fixed            | (#403334) The IBM i LSAM File Arrival jobs and the CHKIFSFIL command were failing to find more than one matching file in the /root file system when a generic* name was used for the file. |
| Fixed            | (#403335, 403336, 403337) The IBM i LSAM general purpose log file (LSALOGF30) could cause a failure of the LSAM server jobs if the file content would exceed 99,999,999 records. This would only happen in an unusual circumstance, but a user configuration error in a Message Management Parameters record command line, such as trying to use nested Dynamic Variable tokens when the nested token does not exist, can cause a run-away generation of error messages. When the log file size exceeded the number of decimal positions allowed for the file’s record ID number field, program error RNX0103 would cause the server jobs to fail. These PTFs implement the disabling of the useless file record number field, and that prevents the LSAM server programs from failing due to the former limitation of the file definition. PTF # 403335 also forces the log file LSALOGF30 to have a size limit instead of *NOMAX, so that when a user configuration error might occur, the system will not be lost due to zero available disk space. Now, if a user configuration error causes  error message run-away, the LSAM server jobs will still be halted until (1) an administrator corrects the configuration error, and (2) an operator responds to the system message reporting that file LSALOGF30 is full. The log file can safely be cleared, if necessary, while the LSAM server jobs are stopped. Otherwise, the file LSALOGF30 can be extended to a larger size, until the LSAM daily log purge program can remove aged records. |
| Fixed            | (#403338) The IBM i LSAM Job Tracking exit program TRKJOBR10 could issue error MCH1210 (receiver too small to hold result) depending on variations in the original SMBJOB command parameter list. This would prevent the job from being submitted, whether it was being tracked or not. This symptom was noted in JD Edwards software environments. Parsing of the SBMJOB parameters has been strengthened to prevent the failure. |
| Fixed            | (#403339) The IBM i LSAM Agent for SMA File Transfer (SMAFT) was failing to separate incoming records as it was writing to the destination file in the DB2 database. This was happening when the source file was a stream file, for example, from a Windows system, and the file did contain record separators. The problem was introduced by a flaw in the previous PTF # 403332. |
| Fixed            | (#403340) The IBM i LSAM Multi-Step Job Script list display (MLTJPBR10) did not stop at the Bottom of the list when pressing PageDown, but would roll back over to the start of the list. |
| Fixed            | (#403341) The IBM i LSAM SMA File Transfer programs are fixed to prevent dropping of characters whenever the UTF-8 (UNICODE) character set was automatically chosen to transport the data. A common example of a transfer job that might drop characters was between two IFS /root file systems both in an IBM i partition. This problem was first reported after PTF # 403332 was installed, but it was always a theoretical weakness in the SMA File Transfer programs of the IBM i LSAM. |
| Fixed            | (#403342) The IBM i LSAM Dynamic Variable Maintenance program failed when using the Search function if it was used once, then Option-2=Change was used, and then Search was attempted again. |
| Fixed            | (#403344) The IBM i LSAM SCANSPLF (Scan Spool File) command and program were failing whenever the SCANSPLF command was being used very frequently to evaluate OpCon job completion status. The LSAJOR server job of the LSAM was reporting an error “NoJobNm”, indicating that no job name was found, when IBM i showed the job did still exist and did have a QPJOBLOG report to be analyzed. The cause of this error was that the SCANSPLFR program was not deleting the list of jobs from the previous searches, so the memory utilized by repeated calls to the list API was extended to its limit, and the system was refusing to list jobs for new searches. Adding a call to the delete-list API removes old lists and frees the memory. |
| Fixed            | (#403345) **WARNING! DO NOT USE THE STRSMA COMMAND TO ENTER THE LSAM MENU SYSTEM WHEN INSTALLING THIS PTF!** Use the command SMAGPL/LSAMENU instead. |
|        | Using the STRSMA command might interfere with the replacement of the STRSMAD display file, depending on the level of the LSAM PTFs when the PTF install process started. |
|        | This PTF redistributes the STRSMA command, its two programs and its display file. Clients who used an LSAM install file older than version  LI040005 did not get the changes made to the STRSMA command display and drivers that were prepared and originally distributed only in the new install file LI040005 (and/or LI040006). This PTF may be applied by all users, but its purpose is to catch up older LSAM installs in order to prevent a CPF4131 level check error on display file STRSMAD from program STRSMAC1. |
| Fixed            | (#403347) The IBM i LSAM data Export/Import feature would fail to process the Import save file and library when attempting to import to a different LSAM environment within the same IBM i partition. |
| Fixed            |  (#403348) The IBM i LSAM “Event Management” function (option 1 in LSAM menu 3) was failing when attempting to display a prompted template for longer OpCon Event Commands, including $NOTIFY:EMAIL and several others. This PTF also adds two new optional parameters to the templates for the $JOB:RESTART and $JOB:RESTARTHLD Event commands. |
| Fixed            | (#403349) The IBM i LSAM data Export/Import feature was not supporting the displayed F12=Cancel function key when the Delete Batch confirmation window appeared, offering an option to also delete the temporary Export/Import library. |
| Fixed            | (#403350, 403351) The IBM i LSAM Agent for SMA File Transfer (SMAFT) was sometimes failing with this error message: “1099 nbConnect error: 03420 Address already in use.” This error would happen for some jobs when many File Transfer jobs were being started in the IBM i system all at once. **POST-INSTALL INSTRUCTIONS**: The Post-Install Instructions explain how to update the LSAM’s SMAFT Parameters using LSAM sub-menu 8, option 7, to change the “linger” values for both the Agent and the Server jobs to ‘0’ (zero). This is important in environments with a high volume of file transfer jobs in order to prevent the “3420: Address already in use” error. |
| Fixed            | (#403353) The IBM i LSAM audit and align utility program SMADTAARAC had an incorrect library location for the SMAPTF data area that resides in library SMAPTF. Program SMADTAARAC is executed by the LSAM utility command LSAINIT, commonly used to audit and align a cloned set of LSAM  environment libraries. |
| Fixed            | (#403354) The IBM i LSAM SMA File Transfer Server job was sending a false error code 034265 to QSYSOPR when a normal remote system disconnect occurred. This symptom started after PTF # 403351 was applied and the SMA File Transfer communications parameters were updated to use a Linger value of 0. |
| Fixed            | (#403355) The IBM i LSAM Parameters maintenance function (LSAM main menu, option 7) was not updating changes to some of the File Arrival job parameters override fields, including the File Arrival Job Description Library name.
| Fixed            | (#403356, 403357) The IBM i LSAM utility command LSAINIT was not correctly setting the SMAUTL data area in newly cloned (by library copy) environments. Additional changes were also made to enforce some rules for the PRDLIB of commands in the SMAGPL library.
| Fixed            | (#403358) The IBM i LSAM utility commands LSAINIT and SMALIBMGT have their PRDLIB (Product Library) changed to *NONE. This setting prevents likely problems when using the CPYLIB command to clone the four LSAM libraries to a new set of libraries, forming a different LSAM environment.
| Fixed            | (#403363) The IBM i LSAM Job Tracking feature was having its $JOB:TRACK and $JOB:QUEUE Event commands rejected by OpCon in non-US environments. The LSAM was failing to fetch the user-specified Separator Character, as maintained by the LSAM sub-menu 1, option 7. This PTF also fixes a weakness in the LSATBLTEST command driver program (LSATBLR), affecting the choice of the EBCDIC character set when the utility is put into CCSID mode.    After this PTF is applied, some non-US environments will need to use the LSATBLTEST command to assure that the chosen Separator Character will cause the LSAM to send an ASCII character of X’7C’ to OpCon, as required by the OpCon Job Tracking process. The LSAM Job Track Configuration screen has been enhanced with a reminder about this requirement. |
| Fixed            | (#403364) The IBM i LSAM File Arrival jobs were failing to accept the special $@VARIABLES from the OpCon job master record in non-US environments. This was caused by different translation tables or different CCSID character sets that could not process the default prefix characters of “$@”. Now the LSAM Utility Configuration function, option 7 in LSAM submenu 3, supports user-defined File Arrival Variable prefix characters. It is the user’s responsibility to assure that the chosen EBCDIC characters will be produced for the LSAM after the OpCon ASCII characters sent with the Job Start request are translated from their ASCII character format. **[SEE POSTINSTALL INSTRUCTIONS.]**